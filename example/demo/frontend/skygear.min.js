'use strict';var skygear=function(n){function Ca(a,b){return b={exports:{}},a(b,b.exports),b.exports}function ja(a){"string"!==typeof a&&(a=String(a));if(/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function Kb(a){"string"!==typeof a&&(a=String(a));return a}function Ya(a){var b={next:function(){var b=a.shift();return{done:void 0===b,value:b}}};r.iterable&&(b[Symbol.iterator]=function(){return b});return b}function t(a){this.map=
{};a instanceof t?a.forEach(function(a,e){this.append(e,a)},this):Array.isArray(a)?a.forEach(function(a){this.append(a[0],a[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(b){this.append(b,a[b])},this)}function Za(a){if(a.bodyUsed)return Promise.reject(new TypeError("Already read"));a.bodyUsed=!0}function Lb(a){return new Promise(function(b,e){a.onload=function(){b(a.result)};a.onerror=function(){e(a.error)}})}function nd(a){var b=new FileReader,e=Lb(b);b.readAsArrayBuffer(a);return e}
function od(a){a=new Uint8Array(a);for(var b=Array(a.length),e=0;e<a.length;e++)b[e]=String.fromCharCode(a[e]);return b.join("")}function Mb(a){if(a.slice)return a.slice(0);var b=new Uint8Array(a.byteLength);b.set(new Uint8Array(a));return b.buffer}function Nb(){this.bodyUsed=!1;this._initBody=function(a){(this._bodyInit=a)?"string"===typeof a?this._bodyText=a:r.blob&&Blob.prototype.isPrototypeOf(a)?this._bodyBlob=a:r.formData&&FormData.prototype.isPrototypeOf(a)?this._bodyFormData=a:r.searchParams&&
URLSearchParams.prototype.isPrototypeOf(a)?this._bodyText=a.toString():r.arrayBuffer&&r.blob&&a&&DataView.prototype.isPrototypeOf(a)?(this._bodyArrayBuffer=Mb(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||pd(a))?this._bodyArrayBuffer=Mb(a):this._bodyText=a=Object.prototype.toString.call(a):this._bodyText="";this.headers.get("content-type")||("string"===typeof a?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&
this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};r.blob&&(this.blob=function(){var a=Za(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},
this.arrayBuffer=function(){return this._bodyArrayBuffer?Za(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(nd)});this.text=function(){var a=Za(this);if(a)return a;if(this._bodyBlob){a=this._bodyBlob;var b=new FileReader,e=Lb(b);b.readAsText(a);return e}if(this._bodyArrayBuffer)return Promise.resolve(od(this._bodyArrayBuffer));if(this._bodyFormData)throw Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};r.formData&&(this.formData=function(){return this.text().then(qd)});
this.json=function(){return this.text().then(JSON.parse)};return this}function T(a,b){b=b||{};var e=b.body;if(a instanceof T){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url;this.credentials=a.credentials;b.headers||(this.headers=new t(a.headers));this.method=a.method;this.mode=a.mode;this.signal=a.signal;e||null==a._bodyInit||(e=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);this.credentials=b.credentials||this.credentials||"same-origin";if(b.headers||!this.headers)this.headers=
new t(b.headers);a=b.method||this.method||"GET";var c=a.toUpperCase();this.method=-1<rd.indexOf(c)?c:a;this.mode=b.mode||this.mode||null;this.signal=b.signal||this.signal;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&e)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e)}function qd(a){var b=new FormData;a.trim().split("&").forEach(function(a){if(a){var c=a.split("=");a=c.shift().replace(/\+/g," ");c=c.join("=").replace(/\+/g," ");b.append(decodeURIComponent(a),
decodeURIComponent(c))}});return b}function sd(a){var b=new t;a.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(a){var c=a.split(":");if(a=c.shift().trim())c=c.join(":").trim(),b.append(a,c)});return b}function F(a,b){b||(b={});this.type="default";this.status=void 0===b.status?200:b.status;this.ok=200<=this.status&&300>this.status;this.statusText="statusText"in b?b.statusText:"OK";this.headers=new t(b.headers);this.url=b.url||"";this._initBody(a)}function Ob(a,b){return new Promise(function(e,
c){function f(){h.abort()}var d=new T(a,b);if(d.signal&&d.signal.aborted)return c(new N("Aborted","AbortError"));var h=new XMLHttpRequest;h.onload=function(){var a={status:h.status,statusText:h.statusText,headers:sd(h.getAllResponseHeaders()||"")};a.url="responseURL"in h?h.responseURL:a.headers.get("X-Request-URL");e(new F("response"in h?h.response:h.responseText,a))};h.onerror=function(){c(new TypeError("Network request failed"))};h.ontimeout=function(){c(new TypeError("Network request failed"))};
h.onabort=function(){c(new N("Aborted","AbortError"))};h.open(d.method,d.url,!0);"include"===d.credentials?h.withCredentials=!0:"omit"===d.credentials&&(h.withCredentials=!1);"responseType"in h&&r.blob&&(h.responseType="blob");d.headers.forEach(function(a,b){h.setRequestHeader(b,a)});d.signal&&(d.signal.addEventListener("abort",f),h.onreadystatechange=function(){4===h.readyState&&d.signal.removeEventListener("abort",f)});h.send("undefined"===typeof d._bodyInit?null:d._bodyInit)})}function y(a,b){if(!(a instanceof
b))throw new TypeError("Cannot call a class as a function");}function ka(a){ka="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return ka(a)}function $a(a){$a="function"===typeof Symbol&&"symbol"===ka(Symbol.iterator)?function(a){return ka(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":
ka(a)};return $a(a)}function Da(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Ea(a,b){return!b||"object"!==$a(b)&&"function"!==typeof b?Da(a):b}function O(a){O=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return O(a)}function la(a,b){la=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return la(a,b)}function Fa(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});b&&la(a,b)}function td(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function ab(a,b,e){ab=td()?Reflect.construct:function(a,b,e){var c=[null];c.push.apply(c,b);a=new (Function.bind.apply(a,c));e&&la(a,e.prototype);return a};
return ab.apply(null,arguments)}function bb(a){var b="function"===typeof Map?new Map:void 0;bb=function(a){function c(){return ab(a,arguments,O(this).constructor)}if(null===a||-1===Function.toString.call(a).indexOf("[native code]"))return a;if("function"!==typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof b){if(b.has(a))return b.get(a);b.set(a,c)}c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});
return la(c,a)};return bb(a)}function Ga(a){return null==a||a instanceof Error||"string"!==typeof a.name||"string"!==typeof a.message?a instanceof Error?a:null!=a&&"string"===typeof a.message?Error(a.message):null!=a&&"function"===typeof a.toString?Error(a.toString()):Error(String(a)):new Pb(a.message,a.name,a.info)}function Qb(a,b,e,c,f,d,h){try{var m=a[d](h),K=m.value}catch(x){e(x);return}m.done?b(K):Promise.resolve(K).then(c,f)}function k(a){return function(){var b=this,e=arguments;return new Promise(function(c,
f){function d(a){Qb(m,c,f,d,h,"next",a)}function h(a){Qb(m,c,f,d,h,"throw",a)}var m=a.apply(b,e);d(void 0)})}}function Rb(a,b){for(var e=0;e<b.length;e++){var c=b[e];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}function L(a,b,e){b&&Rb(a.prototype,b);e&&Rb(a,e);return a}function Ha(a){var b=a.identity,e=a.access_token;a={user:cb(a.user)};b&&(a.identity=db(b));e&&(a.accessToken=e);return a}function cb(a){return{id:a.id,createdAt:new Date(a.created_at),
lastLoginAt:new Date(a.last_login_at),isVerified:a.is_verified,isDisabled:a.is_disabled,metadata:a.metadata}}function db(a){var b=a.id,e=a.type;switch(e){case "password":return{id:b,type:"password",loginIDKey:a.login_id_key,loginID:a.login_id,realm:a.realm,claims:a.claims};case "oauth":return{id:b,type:"oauth",providerType:a.provider_type,providerUserID:a.provider_user_id,rawProfile:a.raw_profile,claims:a.claims};case "custom_token":return{id:b,type:"custom_token",providerUserID:a.provider_user_id,
rawProfile:a.raw_profile,claims:a.claims};default:throw Error("unknown identity type: "+e);}}function Sb(a){var b=a.createdAt.toISOString(),e=a.lastLoginAt.toISOString();return{id:a.id,created_at:b,last_login_at:e,is_verified:a.isVerified,is_disabled:a.isDisabled,metadata:a.metadata}}function Tb(a){switch(a.type){case "password":return{id:a.id,type:"password",login_id_key:a.loginIDKey,login_id:a.loginID,realm:a.realm,claims:a.claims};case "oauth":return{id:a.id,type:"oauth",provider_type:a.providerType,
provider_user_id:a.providerUserID,raw_profile:a.rawProfile,claims:a.claims};case "custom_token":return{id:a.id,type:"custom_token",provider_user_id:a.providerUserID,raw_profile:a.rawProfile,claims:a.claims};default:throw Error("unknown identity type: ");}}function eb(a){return encodeURIComponent(a).replace(/%20/g,"+")}function Ub(a){if(null==a||0>=a.length)return"";for(var b="?",e=0;e<a.length;++e){var c=eb(a[e][0]),f=eb(a[e][1]);if(""!==c||""!==f)"?"!==b&&(b+="&"),b+=c,""!==f&&(b+="=",b+=f)}return b}
function fb(a){return"".concat(a,"_accessToken")}function gb(a){return"".concat(a,"_oauthRedirectAction")}function hb(a,b,e){b in a?Object.defineProperty(a,b,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[b]=e;return a}function Vb(a,b){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(a);b&&(c=c.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));e.push.apply(e,c)}return e}function ud(a){for(var b=1;b<arguments.length;b++){var e=
null!=arguments[b]?arguments[b]:{};b%2?Vb(e,!0).forEach(function(b){hb(a,b,e[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):Vb(e).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(e,b))})}return a}function Wb(a){if(!a)throw Error("unknown message");switch(a.type){case "error":throw Error(a.error);case "result":a=a.result;if(a.error)throw Ga(a.error);return a.result;case "end":throw Error("Fail to retrive result");default:throw Error("unknown message type: "+
a.type);}}var Xb="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ia=function(a){return a&&a.Math==Math&&a},l=Ia("object"==typeof globalThis&&globalThis)||Ia("object"==typeof window&&window)||Ia("object"==typeof self&&self)||Ia("object"==typeof Xb&&Xb)||Function("return this")(),P=function(a){try{return!!a()}catch(b){return!0}},U=!P(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),
E=function(a){return"object"===typeof a?null!==a:"function"===typeof a},V=l.document,Ja=E(V)&&E(V.createElement),Yb=!U&&!P(function(){return 7!=Object.defineProperty(Ja?V.createElement("div"):{},"a",{get:function(){return 7}}).a}),u=function(a){if(!E(a))throw TypeError(String(a)+" is not an object");return a},Zb=function(a,b){if(!E(a))return a;var e,c;if(b&&"function"==typeof(e=a.toString)&&!E(c=e.call(a))||"function"==typeof(e=a.valueOf)&&!E(c=e.call(a))||!b&&"function"==typeof(e=a.toString)&&!E(c=
e.call(a)))return c;throw TypeError("Can't convert object to primitive value");},$b=Object.defineProperty,ma={f:U?$b:function(a,b,e){u(a);b=Zb(b,!0);u(e);if(Yb)try{return $b(a,b,e)}catch(c){}if("get"in e||"set"in e)throw TypeError("Accessors not supported");"value"in e&&(a[b]=e.value);return a}},na=function(a,b){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:b}},p=U?function(a,b,e){return ma.f(a,b,na(1,e))}:function(a,b,e){a[b]=e;return a},ib=function(a,b){try{p(l,a,b)}catch(e){l[a]=
b}return b},Ka=Ca(function(a){var b=l["__core-js_shared__"]||ib("__core-js_shared__",{});(a.exports=function(a,c){return b[a]||(b[a]=void 0!==c?c:{})})("versions",[]).push({version:"3.1.3",mode:"global",copyright:"\u00a9 2019 Denis Pushkarev (zloirock.ru)"})}),vd={}.hasOwnProperty,z=function(a,b){return vd.call(a,b)},La=Ka("native-function-to-string",Function.toString),ac=l.WeakMap,wd="function"===typeof ac&&/native code/.test(La.call(ac)),xd=0,yd=Math.random(),bc=function(a){return"Symbol("+String(void 0===
a?"":a)+")_"+(++xd+yd).toString(36)},cc=Ka("keys"),jb=function(a){return cc[a]||(cc[a]=bc(a))},kb={},zd=l.WeakMap;if(wd){var W=new zd,Ad=W.get,Bd=W.has,Cd=W.set;var lb=function(a,b){Cd.call(W,a,b);return b};var Ma=function(a){return Ad.call(W,a)||{}};var mb=function(a){return Bd.call(W,a)}}else{var oa=jb("state");kb[oa]=!0;lb=function(a,b){p(a,oa,b);return b};Ma=function(a){return z(a,oa)?a[oa]:{}};mb=function(a){return z(a,oa)}}var B={set:lb,get:Ma,has:mb,enforce:function(a){return mb(a)?Ma(a):lb(a,
{})},getterFor:function(a){return function(b){var e;if(!E(b)||(e=Ma(b)).type!==a)throw TypeError("Incompatible receiver, "+a+" required");return e}}},Na=Ca(function(a){var b=B.get,e=B.enforce,c=String(La).split("toString");Ka("inspectSource",function(a){return La.call(a)});(a.exports=function(a,b,h,m){var f=m?!!m.unsafe:!1,d=m?!!m.enumerable:!1;m=m?!!m.noTargetGet:!1;"function"==typeof h&&("string"!=typeof b||z(h,"name")||p(h,"name",b),e(h).source=c.join("string"==typeof b?b:""));a===l?d?a[b]=h:ib(b,
h):(f?!m&&a[b]&&(d=!0):delete a[b],d?a[b]=h:p(a,b,h))})(Function.prototype,"toString",function(){return"function"==typeof this&&b(this).source||La.call(this)})}),Dd={}.toString,Q=function(a){return Dd.call(a).slice(8,-1)},dc=!!Object.getOwnPropertySymbols&&!P(function(){return!String(Symbol())}),ec=l.Symbol,fc=Ka("wks"),v=function(a){return fc[a]||(fc[a]=dc&&ec[a]||(dc?ec:bc)("Symbol."+a))},Ed=v("toStringTag"),Fd="Arguments"==Q(function(){return arguments}()),gc=function(a){var b;if(void 0===a)var e=
"Undefined";else{if(null===a)var c="Null";else{a:{var f=a=Object(a);try{c=f[Ed];break a}catch(d){}c=void 0}c="string"==typeof(e=c)?e:Fd?Q(a):"Object"==(b=Q(a))&&"function"==typeof a.callee?"Arguments":b}e=c}return e},Gd=v("toStringTag"),nb={};nb[Gd]="z";var hc="[object z]"!==String(nb)?function(){return"[object "+gc(this)+"]"}:nb.toString,ic=Object.prototype;hc!==ic.toString&&Na(ic,"toString",hc,{unsafe:!0});var Hd=Math.ceil,Id=Math.floor,ob=function(a){return isNaN(a=+a)?0:(0<a?Id:Hd)(a)},X=function(a){if(void 0==
a)throw TypeError("Can't call method on "+a);return a},jc=function(a){return function(b,e){b=String(X(b));e=ob(e);var c=b.length,f;if(0>e||e>=c)return a?"":void 0;var d=b.charCodeAt(e);return 55296>d||56319<d||e+1===c||56320>(f=b.charCodeAt(e+1))||57343<f?a?b.charAt(e):d:a?b.slice(e,e+2):(d-55296<<10)+(f-56320)+65536}};jc(!1);var Jd=jc(!0),kc={}.propertyIsEnumerable,lc=Object.getOwnPropertyDescriptor,Kd=lc&&!kc.call({1:2},1)?function(a){a=lc(this,a);return!!a&&a.enumerable}:kc,Ld="".split,Oa=P(function(){return!Object("z").propertyIsEnumerable(0)})?
function(a){return"String"==Q(a)?Ld.call(a,""):Object(a)}:Object,mc=Object.getOwnPropertyDescriptor,pb=U?mc:function(a,b){a=Oa(X(a));b=Zb(b,!0);if(Yb)try{return mc(a,b)}catch(e){}if(z(a,b))return na(!Kd.call(a,b),a[b])},nc=function(a){return"function"==typeof a?a:void 0},R=function(a,b){return 2>arguments.length?nc(l[a])||nc(l[a]):l[a]&&l[a][b]||l[a]&&l[a][b]},Md=Math.min,oc=function(a){return 0<a?Md(ob(a),9007199254740991):0},Nd=Math.max,Od=Math.min,pc=function(a){return function(b,e,c){b=Oa(X(b));
var f=oc(b.length);c=ob(c);c=0>c?Nd(c+f,0):Od(c,f);if(a&&e!=e)for(;f>c;){if(e=b[c++],e!=e)return!0}else for(;f>c;c++)if((a||c in b)&&b[c]===e)return a||c||0;return!a&&-1}},Pd={includes:pc(!0),indexOf:pc(!1)}.indexOf,qc=function(a,b){a=Oa(X(a));var e=0,c=[],f;for(f in a)!z(kb,f)&&z(a,f)&&c.push(f);for(;b.length>e;)z(a,f=b[e++])&&(~Pd(c,f)||c.push(f));return c},Pa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Qd=Pa.concat("length","prototype"),
Rd={f:Object.getOwnPropertyNames||function(a){return qc(a,Qd)}},rc=Object.getOwnPropertySymbols,Sd=R("Reflect","ownKeys")||function(a){var b=Rd.f(u(a));return rc?b.concat(rc(a)):b},Td=/#|\.prototype\./,Y=function(a,b){a=Ud[Vd(a)];return a==Wd?!0:a==Xd?!1:"function"==typeof b?P(b):!!b},Vd=Y.normalize=function(a){return String(a).replace(Td,".").toLowerCase()},Ud=Y.data={},Xd=Y.NATIVE="N",Wd=Y.POLYFILL="P",D=function(a,b){var e=a.target,c=a.global,f=a.stat,d,h;if(d=c?l:f?l[e]||ib(e,{}):(l[e]||{}).prototype)for(h in b){var m=
b[h];var g=a.noTargetGet?(g=pb(d,h))&&g.value:d[h];var x=Y(c?h:e+(f?".":"#")+h,a.forced);if(!x&&void 0!==g){if(typeof m===typeof g)continue;x=m;for(var k=g,q=Sd(k),M=ma.f,G=pb,C=0;C<q.length;C++){var n=q[C];z(x,n)||M(x,n,G(k,n))}}(a.sham||g&&g.sham)&&p(m,"sham",!0);Na(d,h,m,a)}},Zd=!P(function(){function a(){}a.prototype.constructor=null;return Object.getPrototypeOf(new a)!==a.prototype}),sc=jb("IE_PROTO"),$d=Object.prototype,pa=Zd?Object.getPrototypeOf:function(a){a=Object(X(a));return z(a,sc)?a[sc]:
"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?$d:null},tc=v("iterator"),uc=!1,ae=function(){return this},Z;if([].keys){var vc=[].keys();if("next"in vc){var wc=pa(pa(vc));wc!==Object.prototype&&(Z=wc)}else uc=!0}void 0==Z&&(Z={});z(Z,tc)||p(Z,tc,ae);var Qa=Z,Ra=uc,be=Object.keys||function(a){return qc(a,Pa)},ce=U?Object.defineProperties:function(a,b){u(a);for(var e=be(b),c=e.length,f=0,d;c>f;)ma.f(a,d=e[f++],b[d]);return a},qb=R("document",
"documentElement"),xc=jb("IE_PROTO"),rb=function(){},Sa=function(){var a=Ja?V.createElement("iframe"):{},b=Pa.length;a.style.display="none";qb.appendChild(a);a.src="javascript:";a=a.contentWindow.document;a.open();a.write("<script>document.F=Object\x3c/script>");a.close();for(Sa=a.F;b--;)delete Sa.prototype[Pa[b]];return Sa()},sb=Object.create||function(a,b){if(null!==a){rb.prototype=u(a);var e=new rb;rb.prototype=null;e[xc]=a}else e=Sa();return void 0===b?e:ce(e,b)};kb[xc]=!0;var de=ma.f,yc=v("toStringTag"),
tb=function(a,b,e){a&&!z(a=e?a:a.prototype,yc)&&de(a,yc,{configurable:!0,value:b})},aa={},ee=function(){return this},fe=function(a,b,e){b+=" Iterator";a.prototype=sb(Qa,{next:na(1,e)});tb(a,b,!1);aa[b]=ee;return a},Ta=Object.setPrototypeOf||("__proto__"in{}?function(){var a=!1,b={};try{var e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;e.call(b,[]);a=b instanceof Array}catch(c){}return function(b,f){u(b);if(!E(f)&&null!==f)throw TypeError("Can't set "+String(f)+" as a prototype");
a?e.call(b,f):b.__proto__=f;return b}}():void 0),qa=v("iterator"),ge=function(){return this},zc=function(a,b,e,c,f,d,h){fe(e,b,c);c=function(a){if(a===f&&q)return q;if(!Ra&&a in x)return x[a];switch(a){case "keys":return function(){return new e(this,a)};case "values":return function(){return new e(this,a)};case "entries":return function(){return new e(this,a)}}return function(){return new e(this)}};var m=b+" Iterator",g=!1,x=a.prototype,k=x[qa]||x["@@iterator"]||f&&x[f],q=!Ra&&k||c(f),l="Array"==
b?x.entries||k:k,G;l&&(a=pa(l.call(new a)),Qa!==Object.prototype&&a.next&&(pa(a)!==Qa&&(Ta?Ta(a,Qa):"function"!=typeof a[qa]&&p(a,qa,ge)),tb(a,m,!0)));"values"==f&&k&&"values"!==k.name&&(g=!0,q=function(){return k.call(this)});x[qa]!==q&&p(x,qa,q);aa[b]=q;if(f){var C={values:c("values"),keys:d?q:c("keys"),entries:c("entries")};if(h)for(G in C)!Ra&&!g&&G in x||Na(x,G,C[G]);else D({target:b,proto:!0,forced:Ra||g},C)}return C},he=B.set,ie=B.getterFor("String Iterator");zc(String,"String",function(a){he(this,
{type:"String Iterator",string:String(a),index:0})},function(){var a=ie(this),b=a.string,e=a.index;if(e>=b.length)return{value:void 0,done:!0};b=Jd(b,e);a.index+=b.length;return{value:b,done:!1}});var Ac={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,
PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ra=v("unscopables"),sa=Array.prototype;void 0==sa[ra]&&p(sa,ra,sb(null));var je=B.set,ke=B.getterFor("Array Iterator"),ta=zc(Array,"Array",function(a,b){je(this,{type:"Array Iterator",target:Oa(X(a)),index:0,kind:b})},function(){var a=ke(this),b=a.target,e=a.kind,c=a.index++;return!b||c>=b.length?(a.target=
void 0,{value:void 0,done:!0}):"keys"==e?{value:c,done:!1}:"values"==e?{value:b[c],done:!1}:{value:[c,b[c]],done:!1}},"values");aa.Arguments=aa.Array;sa[ra].keys=!0;sa[ra].values=!0;sa[ra].entries=!0;var ub=v("iterator"),Bc=v("toStringTag"),vb=ta.values,Ua;for(Ua in Ac){var Cc=l[Ua],w=Cc&&Cc.prototype;if(w){if(w[ub]!==vb)try{p(w,ub,vb)}catch(a){w[ub]=vb}w[Bc]||p(w,Bc,Ua);if(Ac[Ua])for(var ba in ta)if(w[ba]!==ta[ba])try{p(w,ba,ta[ba])}catch(a){w[ba]=ta[ba]}}}var le=function(a,b,e){for(var c in b)Na(a,
c,b[c],e);return a},Dc=v("species"),A=function(a){if("function"!=typeof a)throw TypeError(String(a)+" is not a function");return a},me=v("iterator"),ne=Array.prototype,Ec=function(a,b,e){A(a);if(void 0===b)return a;switch(e){case 0:return function(){return a.call(b)};case 1:return function(c){return a.call(b,c)};case 2:return function(c,e){return a.call(b,c,e)};case 3:return function(c,e,d){return a.call(b,c,e,d)}}return function(){return a.apply(b,arguments)}},oe=v("iterator"),ua=Ca(function(a){var b=
function(a,b){this.stopped=a;this.result=b};(a.exports=function(a,c,f,d,h){c=Ec(c,f,d?2:1);var e,g;if(h)h=a;else{h=void 0!=a?a[oe]||a["@@iterator"]||aa[gc(a)]:void 0;if("function"!=typeof h)throw TypeError("Target is not iterable");if(void 0!==h&&(aa.Array===h||ne[me]===h)){h=0;for(f=oc(a.length);f>h;h++)if((e=d?c(u(g=a[h])[0],g[1]):c(a[h]))&&e instanceof b)return e;return new b(!1)}h=h.call(a)}for(;!(g=h.next()).done;){a=h;f=c;g=g.value;try{e=d?f(u(g)[0],g[1]):f(g)}catch(x){throw d=a["return"],void 0!==
d&&u(d.call(a)),x;}if(e&&e instanceof b)return e}return new b(!1)}).stop=function(a){return new b(!0,a)}}),Fc=v("iterator"),Gc=!1;try{var pe=0,Hc={next:function(){return{done:!!pe++}},"return":function(){Gc=!0}};Hc[Fc]=function(){return this};Array.from(Hc,function(){throw 2;})}catch(a){}var qe=function(a,b){if(!b&&!Gc)return!1;var e=!1;try{b={},b[Fc]=function(){return{next:function(){return{done:e=!0}}}},a(b)}catch(c){}return e},re=v("species"),Ic=function(a,b){a=u(a).constructor;var e;return void 0===
a||void 0==(e=u(a)[re])?b:A(e)},Jc=l.location,wb=l.setImmediate,Kc=l.clearImmediate,Lc=l.process,Mc=l.MessageChannel,xb=l.Dispatch,yb=0,va={},zb=function(a){if(va.hasOwnProperty(a)){var b=va[a];delete va[a];b()}},Ab=function(a){return function(){zb(a)}},Nc=function(a){zb(a.data)},Oc=function(a){l.postMessage(a+"",Jc.protocol+"//"+Jc.host)};if(!wb||!Kc)if(wb=function(a){for(var b=[],e=1;arguments.length>e;)b.push(arguments[e++]);va[++yb]=function(){("function"==typeof a?a:Function(a)).apply(void 0,
b)};wa(yb);return yb},Kc=function(a){delete va[a]},"process"==Q(Lc))var wa=function(a){Lc.nextTick(Ab(a))};else if(xb&&xb.now)wa=function(a){xb.now(Ab(a))};else if(Mc){var Pc=new Mc;var Qc=Pc.port2;Pc.port1.onmessage=Nc;wa=Ec(Qc.postMessage,Qc,1)}else!l.addEventListener||"function"!=typeof postMessage||l.importScripts||P(Oc)?wa="onreadystatechange"in(Ja?V.createElement("script"):{})?function(a){qb.appendChild(Ja?V.createElement("script"):{}).onreadystatechange=function(){qb.removeChild(this);zb(a)}}:
function(a){setTimeout(Ab(a),0)}:(wa=Oc,l.addEventListener("message",Nc,!1));var Bb=wb,Rc=R("navigator","userAgent")||"",Sc=l.MutationObserver||l.WebKitMutationObserver,Cb=l.process,Db=l.Promise,Tc="process"==Q(Cb),Uc=pb(l,"queueMicrotask"),Vc=Uc&&Uc.value,S,xa;if(!Vc){var Va=function(){var a;for(Tc&&(a=Cb.domain)&&a.exit();S;){var b=S.fn;S=S.next;try{b()}catch(e){throw S?ya():xa=void 0,e;}}xa=void 0;a&&a.enter()};if(Tc)var ya=function(){Cb.nextTick(Va)};else if(Sc&&!/(iphone|ipod|ipad).*applewebkit/i.test(Rc)){var Wc=
!0;var Xc=document.createTextNode("");(new Sc(Va)).observe(Xc,{characterData:!0});ya=function(){Xc.data=Wc=!Wc}}else if(Db&&Db.resolve){var se=Db.resolve(void 0);ya=function(){se.then(Va)}}else ya=function(){Bb.call(l,Va)}}var Yc=Vc||function(a){a={fn:a,next:void 0};xa&&(xa.next=a);S||(S=a,ya());xa=a},te=function(a){var b,e;this.promise=new a(function(a,f){if(void 0!==b||void 0!==e)throw TypeError("Bad Promise constructor");b=a;e=f});this.resolve=A(b);this.reject=A(e)},ca={f:function(a){return new te(a)}},
Wa=function(a,b){u(a);if(E(b)&&b.constructor===a)return b;a=ca.f(a);var e=a.resolve;e(b);return a.promise},ue=function(a,b){var e=l.console;e&&e.error&&(1===arguments.length?e.error(a):e.error(a,b))},da=function(a){try{return{error:!1,value:a()}}catch(b){return{error:!0,value:b}}},ve=v("species"),Zc=B.get,we=B.set,xe=B.getterFor("Promise"),H=l.Promise,$c=l.TypeError,Eb=l.document,ea=l.process,ad=l.fetch,bd=ea&&ea.versions,ye=bd&&bd.v8||"",fa=ca.f,ze=fa,za="process"==Q(ea),Ae=!!(Eb&&Eb.createEvent&&
l.dispatchEvent),Aa=Y("Promise",function(){var a=H.resolve(1),b=function(){},e=(a.constructor={})[ve]=function(a){a(b,b)};return!((za||"function"==typeof PromiseRejectionEvent)&&a.then(b)instanceof e&&0!==ye.indexOf("6.6")&&-1===Rc.indexOf("Chrome/66"))}),Be=Aa||!qe(function(a){H.all(a)["catch"](function(){})}),cd=function(a){var b;return E(a)&&"function"==typeof(b=a.then)?b:!1},Fb=function(a,b,e){if(!b.notified){b.notified=!0;var c=b.reactions;Yc(function(){for(var f=b.value,d=1==b.state,h=0;c.length>
h;){var m=c[h++],g=d?m.ok:m.fail,k=m.resolve,l=m.reject,q=m.domain,M;try{if(g){d||(2===b.rejection&&Ce(a,b),b.rejection=1);if(!0===g)var G=f;else if(q&&q.enter(),G=g(f),q){q.exit();var C=!0}G===m.promise?l($c("Promise-chain cycle")):(M=cd(G))?M.call(G,k,l):k(G)}else l(f)}catch(Yd){q&&!C&&q.exit(),l(Yd)}}b.reactions=[];b.notified=!1;e&&!b.rejection&&De(a,b)})}},dd=function(a,b,e){var c;if(Ae){var f=Eb.createEvent("Event");f.promise=b;f.reason=e;f.initEvent(a,!1,!0);l.dispatchEvent(f)}else f={promise:b,
reason:e};(c=l["on"+a])?c(f):"unhandledrejection"===a&&ue("Unhandled promise rejection",e)},De=function(a,b){Bb.call(l,function(){var e=b.value;if(1!==b.rejection&&!b.parent){var c=da(function(){za?ea.emit("unhandledRejection",e,a):dd("unhandledrejection",a,e)});b.rejection=za||1!==b.rejection&&!b.parent?2:1;if(c.error)throw c.value;}})},Ce=function(a,b){Bb.call(l,function(){za?ea.emit("rejectionHandled",a):dd("rejectionhandled",a,b.value)})},ha=function(a,b,e,c){return function(f){a(b,e,f,c)}},ia=
function(a,b,e,c){b.done||(b.done=!0,c&&(b=c),b.value=e,b.state=2,Fb(a,b,!0))},Gb=function(a,b,e,c){if(!b.done){b.done=!0;c&&(b=c);try{if(a===e)throw $c("Promise can't be resolved itself");var f=cd(e);f?Yc(function(){var c={done:!1};try{f.call(e,ha(Gb,a,c,b),ha(ia,a,c,b))}catch(h){ia(a,c,h,b)}}):(b.value=e,b.state=1,Fb(a,b,!1))}catch(d){ia(a,{done:!1},d,b)}}};if(Aa){H=function(a){if(!(this instanceof H))throw TypeError("Incorrect Promise invocation");A(a);Hb.call(this);var b=Zc(this);try{a(ha(Gb,
this,b),ha(ia,this,b))}catch(e){ia(this,b,e)}};var Hb=function(a){we(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};Hb.prototype=le(H.prototype,{then:function(a,b){var e=xe(this),c=fa(Ic(this,H));c.ok="function"==typeof a?a:!0;c.fail="function"==typeof b&&b;c.domain=za?ea.domain:void 0;e.parent=!0;e.reactions.push(c);0!=e.state&&Fb(this,e,!1);return c.promise},"catch":function(a){return this.then(void 0,a)}});var Ee=function(){var a=new Hb,b=Zc(a);
this.promise=a;this.resolve=ha(Gb,a,b);this.reject=ha(ia,a,b)};ca.f=fa=function(a){return a===H||a===Fe?new Ee(a):ze(a)};"function"==typeof ad&&D({global:!0,enumerable:!0,forced:!0},{fetch:function(a){return Wa(H,ad.apply(l,arguments))}})}D({global:!0,wrap:!0,forced:Aa},{Promise:H});tb(H,"Promise",!1);(function(a){a=R(a);var b=ma.f;U&&a&&!a[Dc]&&b(a,Dc,{configurable:!0,get:function(){return this}})})("Promise");var Fe=l.Promise;D({target:"Promise",stat:!0,forced:Aa},{reject:function(a){var b=fa(this);
b.reject.call(void 0,a);return b.promise}});D({target:"Promise",stat:!0,forced:Aa},{resolve:function(a){return Wa(this,a)}});D({target:"Promise",stat:!0,forced:Be},{all:function(a){var b=this,e=fa(b),c=e.resolve,f=e.reject,d=da(function(){var e=A(b.resolve),d=[],g=0,k=1;ua(a,function(a){var h=g++,m=!1;d.push(void 0);k++;e.call(b,a).then(function(a){m||(m=!0,d[h]=a,--k||c(d))},f)});--k||c(d)});d.error&&f(d.value);return e.promise},race:function(a){var b=this,e=fa(b),c=e.reject,f=da(function(){var d=
A(b.resolve);ua(a,function(a){d.call(b,a).then(e.resolve,c)})});f.error&&c(f.value);return e.promise}});D({target:"Promise",proto:!0,real:!0},{"finally":function(a){var b=Ic(this,R("Promise")),e="function"==typeof a;return this.then(e?function(c){return Wa(b,a()).then(function(){return c})}:a,e?function(c){return Wa(b,a()).then(function(){throw c;})}:a)}});var Ba=function(a,b){var e=this;if(!(e instanceof Ba))return new Ba(a,b);Ta&&(e=Ta(Error(b),pa(e)));var c=[];ua(a,c.push,c);e.errors=c;void 0!==
b&&p(e,"message",String(b));return e};Ba.prototype=sb(Error.prototype,{constructor:na(5,Ba),name:na(5,"AggregateError")});D({global:!0},{AggregateError:Ba});D({target:"Promise",stat:!0},{allSettled:function(a){var b=this,e=ca.f(b),c=e.resolve,f=e.reject,d=da(function(){var e=A(b.resolve),d=[],f=0,g=1;ua(a,function(a){var h=f++,m=!1;d.push(void 0);g++;e.call(b,a).then(function(a){m||(m=!0,d[h]={status:"fulfilled",value:a},--g||c(d))},function(a){m||(m=!0,d[h]={status:"rejected",reason:a},--g||c(d))})});
--g||c(d)});d.error&&f(d.value);return e.promise}});D({target:"Promise",stat:!0},{"try":function(a){var b=ca.f(this);a=da(a);(a.error?b.reject:b.resolve)(a.value);return b.promise}});D({target:"Promise",stat:!0},{any:function(a){var b=this,e=ca.f(b),c=e.resolve,f=e.reject,d=da(function(){var e=A(b.resolve),d=[],g=0,k=1,l=!1;ua(a,function(a){var h=g++,m=!1;d.push(void 0);k++;e.call(b,a).then(function(a){m||l||(l=!0,c(a))},function(a){m||l||(m=!0,d[h]=a,--k||f(new (R("AggregateError"))(d,"No one promise resolved")))})});
--k||f(new (R("AggregateError"))(d,"No one promise resolved"))});d.error&&f(d.value);return e.promise}});var Ge="URLSearchParams"in self,He="Symbol"in self&&"iterator"in Symbol,Xa;if(Xa="FileReader"in self&&"Blob"in self)try{new Blob,Xa=!0}catch(a){Xa=!1}var r={searchParams:Ge,iterable:He,blob:Xa,formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(r.arrayBuffer)var Ie="[object Int8Array];[object Uint8Array];[object Uint8ClampedArray];[object Int16Array];[object Uint16Array];[object Int32Array];[object Uint32Array];[object Float32Array];[object Float64Array]".split(";"),
pd=ArrayBuffer.isView||function(a){return a&&-1<Ie.indexOf(Object.prototype.toString.call(a))};t.prototype.append=function(a,b){a=ja(a);b=Kb(b);var e=this.map[a];this.map[a]=e?e+", "+b:b};t.prototype["delete"]=function(a){delete this.map[ja(a)]};t.prototype.get=function(a){a=ja(a);return this.has(a)?this.map[a]:null};t.prototype.has=function(a){return this.map.hasOwnProperty(ja(a))};t.prototype.set=function(a,b){this.map[ja(a)]=Kb(b)};t.prototype.forEach=function(a,b){for(var e in this.map)this.map.hasOwnProperty(e)&&
a.call(b,this.map[e],e,this)};t.prototype.keys=function(){var a=[];this.forEach(function(b,e){a.push(e)});return Ya(a)};t.prototype.values=function(){var a=[];this.forEach(function(b){a.push(b)});return Ya(a)};t.prototype.entries=function(){var a=[];this.forEach(function(b,e){a.push([e,b])});return Ya(a)};r.iterable&&(t.prototype[Symbol.iterator]=t.prototype.entries);var rd="DELETE GET HEAD OPTIONS POST PUT".split(" ");T.prototype.clone=function(){return new T(this,{body:this._bodyInit})};Nb.call(T.prototype);
Nb.call(F.prototype);F.prototype.clone=function(){return new F(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new t(this.headers),url:this.url})};F.error=function(){var a=new F(null,{status:0,statusText:""});a.type="error";return a};var Je=[301,302,303,307,308];F.redirect=function(a,b){if(-1===Je.indexOf(b))throw new RangeError("Invalid status code");return new F(null,{status:b,headers:{location:a}})};var N=self.DOMException;try{new N}catch(a){N=function(a,e){this.message=a;
this.name=e;this.stack=Error(a).stack},N.prototype=Object.create(Error.prototype),N.prototype.constructor=N}Ob.polyfill=!0;self.fetch||(self.fetch=Ob,self.Headers=t,self.Request=T,self.Response=F);var Pb=function(a){function b(a,c,f){y(this,b);a=Ea(this,O(b).call(this,a));a.name=c;a.info=f;return a}Fa(b,a);return b}(bb(Error)),g=Ca(function(a){a=function(a){function b(a,b,c,d){b=Object.create((b&&b.prototype instanceof f?b:f).prototype);d=new n(d||[]);b._invoke=k(a,c,d);return b}function c(a,b,c){try{return{type:"normal",
arg:a.call(b,c)}}catch(Ke){return{type:"throw",arg:Ke}}}function f(){}function d(){}function h(){}function m(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function g(a){function b(d,e,h,f){d=c(a[d],a,e);if("throw"===d.type)f(d.arg);else{var m=d.arg;return(d=m.value)&&"object"===typeof d&&r.call(d,"__await")?Promise.resolve(d.__await).then(function(a){b("next",a,h,f)},function(a){b("throw",a,h,f)}):Promise.resolve(d).then(function(a){m.value=a;h(m)},
function(a){return b("throw",a,h,f)})}}var d;this._invoke=function(a,c){function h(){return new Promise(function(d,h){b(a,c,d,h)})}return d=d?d.then(h,h):h()}}function k(a,b,d){var h=D;return function(e,f){if(h===F)throw Error("Generator is already running");if(h===B){if("throw"===e)throw f;return t()}d.method=e;for(d.arg=f;;){if(e=d.delegate)if(e=l(e,d)){if(e===J)continue;return e}if("next"===d.method)d.sent=d._sent=d.arg;else if("throw"===d.method){if(h===D)throw h=B,d.arg;d.dispatchException(d.arg)}else"return"===
d.method&&d.abrupt("return",d.arg);h=F;e=c(a,b,d);if("normal"===e.type){h=d.done?B:H;if(e.arg===J)continue;return{value:e.arg,done:d.done}}"throw"===e.type&&(h=B,d.method="throw",d.arg=e.arg)}}}function l(a,b){var d=a.iterator[b.method];if(d===p){b.delegate=null;if("throw"===b.method){if(a.iterator["return"]&&(b.method="return",b.arg=p,l(a,b),"throw"===b.method))return J;b.method="throw";b.arg=new TypeError("The iterator does not provide a 'throw' method")}return J}d=c(d,a.iterator,b.arg);if("throw"===
d.type)return b.method="throw",b.arg=d.arg,b.delegate=null,J;d=d.arg;if(!d)return b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,J;if(d.done)b[a.resultName]=d.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=p);else return d;b.delegate=null;return J}function q(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]);2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]);this.tryEntries.push(b)}function M(a){var b=a.completion||{};b.type="normal";delete b.arg;
a.completion=b}function n(a){this.tryEntries=[{tryLoc:"root"}];a.forEach(q,this);this.reset(!0)}function C(a){if(a){var b=a[y];if(b)return b.call(a);if("function"===typeof a.next)return a;if(!isNaN(a.length)){var c=-1;b=function I(){for(;++c<a.length;)if(r.call(a,c))return I.value=a[c],I.done=!1,I;I.value=p;I.done=!0;return I};return b.next=b}}return{next:t}}function t(){return{value:p,done:!0}}var v=Object.prototype,r=v.hasOwnProperty,p,u="function"===typeof Symbol?Symbol:{},y=u.iterator||"@@iterator",
E=u.asyncIterator||"@@asyncIterator",z=u.toStringTag||"@@toStringTag";a.wrap=b;var D="suspendedStart",H="suspendedYield",F="executing",B="completed",J={};u={};u[y]=function(){return this};var w=Object.getPrototypeOf;(w=w&&w(w(C([]))))&&w!==v&&r.call(w,y)&&(u=w);var A=h.prototype=f.prototype=Object.create(u);d.prototype=A.constructor=h;h.constructor=d;h[z]=d.displayName="GeneratorFunction";a.isGeneratorFunction=function(a){return(a="function"===typeof a&&a.constructor)?a===d||"GeneratorFunction"===
(a.displayName||a.name):!1};a.mark=function(a){Object.setPrototypeOf?Object.setPrototypeOf(a,h):(a.__proto__=h,z in a||(a[z]="GeneratorFunction"));a.prototype=Object.create(A);return a};a.awrap=function(a){return{__await:a}};m(g.prototype);g.prototype[E]=function(){return this};a.AsyncIterator=g;a.async=function(c,d,h,e){var f=new g(b(c,d,h,e));return a.isGeneratorFunction(d)?f:f.next().then(function(a){return a.done?a.value:f.next()})};m(A);A[z]="Generator";A[y]=function(){return this};A.toString=
function(){return"[object Generator]"};a.keys=function(a){var b=[],c;for(c in a)b.push(c);b.reverse();return function I(){for(;b.length;){var c=b.pop();if(c in a)return I.value=c,I.done=!1,I}I.done=!0;return I}};a.values=C;n.prototype={constructor:n,reset:function(a){this.next=this.prev=0;this.sent=this._sent=p;this.done=!1;this.delegate=null;this.method="next";this.arg=p;this.tryEntries.forEach(M);if(!a)for(var b in this)"t"===b.charAt(0)&&r.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=p)},stop:function(){this.done=
!0;var a=this.tryEntries[0].completion;if("throw"===a.type)throw a.arg;return this.rval},dispatchException:function(a){function b(b,d){e.type="throw";e.arg=a;c.next=b;d&&(c.method="next",c.arg=p);return!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;0<=d;--d){var h=this.tryEntries[d],e=h.completion;if("root"===h.tryLoc)return b("end");if(h.tryLoc<=this.prev){var f=r.call(h,"catchLoc"),m=r.call(h,"finallyLoc");if(f&&m){if(this.prev<h.catchLoc)return b(h.catchLoc,!0);if(this.prev<
h.finallyLoc)return b(h.finallyLoc)}else if(f){if(this.prev<h.catchLoc)return b(h.catchLoc,!0)}else if(m){if(this.prev<h.finallyLoc)return b(h.finallyLoc)}else throw Error("try statement without catch or finally");}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;0<=c;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&r.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var h=d;break}}h&&("break"===a||"continue"===a)&&h.tryLoc<=b&&b<=h.finallyLoc&&(h=null);c=h?h.completion:{};c.type=a;c.arg=
b;return h?(this.method="next",this.next=h.finallyLoc,J):this.complete(c)},complete:function(a,b){if("throw"===a.type)throw a.arg;"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b);return J},finish:function(a){for(var b=this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),M(c),J}},"catch":function(a){for(var b=
this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];if(c.tryLoc===a){a=c.completion;if("throw"===a.type){var d=a.arg;M(c)}return d}}throw Error("illegal catch attempt");},delegateYield:function(a,b,c){this.delegate={iterator:C(a),resultName:b,nextLoc:c};"next"===this.method&&(this.arg=p);return J}};return a}(a.exports);try{regeneratorRuntime=a}catch(b){Function("r","regeneratorRuntime = r")(a)}}),ed=function(){function a(b){y(this,a);this.apiKey=b.apiKey;this.endpoint=b.endpoint.replace(/\/+$/g,
"");this.accessToken=b.accessToken}L(a,[{key:"prepareHeaders",value:function(){var a={"x-skygear-api-key":this.apiKey};this.accessToken&&(a["x-skygear-access-token"]=this.accessToken);return a}},{key:"fetch",value:function(){var a=k(g.mark(function d(a,b){var c,f,K,k,l,q;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(null!=this.requestClass){d.next=2;break}throw Error("missing requestClass in api client");case 2:if("string"===typeof a){d.next=4;break}throw Error("only string path is allowed for fetch input");
case 4:c=this.endpoint+"/"+a.replace(/^\//,"");f=new this.requestClass(c,b);K=this.prepareHeaders();k=0;for(l=Object.keys(K);k<l.length;k++)q=l[k],f.headers.set(q,K[q]);if(null!=this.fetchFunction){d.next=10;break}throw Error("missing fetchFunction in api client");case 10:return d.abrupt("return",this.fetchFunction(f));case 11:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"request",value:function(){var a=k(g.mark(function d(a,b){var c,f,K,k,
l,q,n,p=arguments;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=2<p.length&&void 0!==p[2]?p[2]:{},f=c.json,K=c.query,k=b,null!=K&&(k+=Ub(K)),l={},null!=f&&(l["content-type"]="application/json"),d.next=8,this.fetch(k,{method:a,headers:l,mode:"cors",credentials:"include",body:f&&JSON.stringify(f)});case 8:return q=d.sent,d.next=11,q.json();case 11:n=d.sent;if(!n.result){d.next=16;break}return d.abrupt("return",n.result);case 16:if(!n.error){d.next=18;break}throw Ga(n.error);
case 18:throw Ga();case 19:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"post",value:function(){var a=k(g.mark(function d(a,b){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.request("POST",a,b));case 1:case "end":return c.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"get",value:function(){var a=k(g.mark(function d(a,b){return g.wrap(function(c){for(;;)switch(c.prev=
c.next){case 0:return c.abrupt("return",this.request("GET",a,b));case 1:case "end":return c.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"del",value:function(){var a=k(g.mark(function d(a,b){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.request("DELETE",a,b));case 1:case "end":return c.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"postAndReturnAuthResponse",value:function(){var a=
k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.post(a,b);case 2:return c=d.sent,d.abrupt("return",Ha(c));case 4:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"signup",value:function(){var a=k(g.mark(function h(a,b,d){var c,f,k,l,q,n,p,r,t,u,v,w;return g.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:c=[];if(Array.isArray(a))for(f=0;f<a.length;f++)for(k=a[f],l=0,q=Object.keys(k);l<
q.length;l++)n=q[l],p=k[n],c.push({key:n,value:p});else for(r=0,t=Object.keys(a);r<t.length;r++)u=t[r],v=a[u],c.push({key:u,value:v});w={password:b,login_ids:c,realm:d&&d.realm,metadata:d&&d.metadata};return h.abrupt("return",this.postAndReturnAuthResponse("/_auth/signup",{json:w}));case 4:case "end":return h.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"login",value:function(){var a=k(g.mark(function h(a,b,d){var c;return g.wrap(function(h){for(;;)switch(h.prev=
h.next){case 0:return c={password:b,login_id:a,login_id_key:d&&d.loginIDKey,realm:d&&d.realm},h.abrupt("return",this.postAndReturnAuthResponse("/_auth/login",{json:c}));case 2:case "end":return h.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"logout",value:function(){var a=k(g.mark(function c(){return g.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.post("/_auth/logout");case 2:case "end":return a.stop()}},c,this)}));return function(){return a.apply(this,
arguments)}}()},{key:"me",value:function(){var a=k(g.mark(function c(){return g.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.postAndReturnAuthResponse("/_auth/me"));case 1:case "end":return a.stop()}},c,this)}));return function(){return a.apply(this,arguments)}}()},{key:"changePassword",value:function(){var a=k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c={password:a,old_password:b},d.abrupt("return",this.postAndReturnAuthResponse("/_auth/change_password",
{json:c}));case 2:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"updateMetadata",value:function(){var a=k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b={metadata:a},c.abrupt("return",this.postAndReturnAuthResponse("/_auth/update_metadata",{json:b}));case 2:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"requestForgotPasswordEmail",value:function(){var a=
k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b={email:a},c.next=3,this.post("/_auth/forgot_password",{json:b});case 3:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var a=k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b={user_id:a.userID,code:a.code,expire_at:a.expireAt,new_password:a.newPassword},c.next=3,this.post("/_auth/forgot_password/reset_password",
{json:b});case 3:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"requestEmailVerification",value:function(){var a=k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b={login_id_type:"email",login_id:a},c.next=3,this.post("/_auth/verify_request",{json:b});case 3:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"verifyWithCode",value:function(){var a=
k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b={code:a},c.next=3,this.post("/_auth/verify_code",{json:b});case 3:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"loginWithCustomToken",value:function(){var a=k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c={token:a,merge_realm:b&&b.mergeRealm,on_user_duplicate:b&&b.onUserDuplicate},d.abrupt("return",
this.postAndReturnAuthResponse("/_auth/sso/custom_token/login",{json:c}));case 2:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"oauthAuthorizationURL",value:function(){var a=k(g.mark(function d(a,b){var c,f,k,l,n;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:c=encodeURIComponent(a);f=b.action;k="";d.t0=f;d.next="login"===d.t0?6:"link"===d.t0?8:10;break;case 6:return k="/_auth/sso/".concat(c,"/login_auth_url"),d.abrupt("break",
11);case 8:return k="/_auth/sso/".concat(c,"/link_auth_url"),d.abrupt("break",11);case 10:throw Error("unreachable");case 11:if(l="callbackURL"in b&&b.callbackURL||"undefined"!==typeof window&&window.location.href){d.next=14;break}throw Error("callbackURL is required");case 14:return n={callback_url:l,ux_mode:b.uxMode,merge_realm:b.mergeRealm,on_user_duplicate:b.onUserDuplicate},d.abrupt("return",this.post(k,{json:n}));case 16:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,
arguments)}}()},{key:"deleteOAuthProvider",value:function(){var a=k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b=encodeURIComponent(a),c.next=3,this.post("/_auth/sso/".concat(b,"/unlink"));case 3:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"loginOAuthProviderWithAccessToken",value:function(){var a=k(g.mark(function h(a,b,d){var c,f;return g.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c=
encodeURIComponent(a),f={access_token:b,merge_realm:d&&d.mergeRealm,on_user_duplicate:d&&d.onUserDuplicate},h.abrupt("return",this.postAndReturnAuthResponse("/_auth/sso/".concat(c,"/login"),{json:f}));case 3:case "end":return h.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"linkOAuthProviderWithAccessToken",value:function(){var a=k(g.mark(function d(a,b){var c,f;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=encodeURIComponent(a),f={access_token:b},
d.abrupt("return",this.postAndReturnAuthResponse("/_auth/sso/".concat(c,"/link"),{json:f}));case 3:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()}]);return a}(),Ib=function(){function a(b){y(this,a);this.parent=b;this.currentIdentity=this.currentUser=null}L(a,[{key:"persistResponse",value:function(){var a=k(g.mark(function f(a){var b,c,m;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return b=a.user,c=a.identity,m=a.accessToken,d.next=
3,this.parent.storage.setUser(this.parent.name,b);case 3:if(!c){d.next=6;break}d.next=6;return this.parent.storage.setIdentity(this.parent.name,c);case 6:if(!m){d.next=9;break}d.next=9;return this.parent.storage.setAccessToken(this.parent.name,m);case 9:this.currentUser=b,c&&(this.currentIdentity=c),m&&(this.parent.apiClient.accessToken=m);case 12:case "end":return d.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"signup",value:function(){var a=k(g.mark(function h(a,
b,d){var c;return g.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.parent.apiClient.signup(a,b,d);case 2:return c=f.sent,f.next=5,this.persistResponse(c);case 5:return f.abrupt("return",c.user);case 6:case "end":return f.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"signupWithEmail",value:function(){var a=k(g.mark(function h(a,b,d){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.signup({email:a},
b,d));case 1:case "end":return c.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"signupWithUsername",value:function(){var a=k(g.mark(function h(a,b,d){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.signup({username:a},b,d));case 1:case "end":return c.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"login",value:function(){var a=k(g.mark(function h(a,b,d){var c;return g.wrap(function(f){for(;;)switch(f.prev=
f.next){case 0:return f.next=2,this.parent.apiClient.login(a,b,d);case 2:return c=f.sent,f.next=5,this.persistResponse(c);case 5:return f.abrupt("return",c.user);case 6:case "end":return f.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"logout",value:function(){var a=k(g.mark(function c(){return g.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.parent.apiClient.logout();case 2:return a.next=4,this.parent.storage.delUser(this.parent.name);
case 4:return a.next=6,this.parent.storage.delIdentity(this.parent.name);case 6:return a.next=8,this.parent.storage.delAccessToken(this.parent.name);case 8:this.currentIdentity=this.currentUser=null,this.parent.apiClient.accessToken=null;case 11:case "end":return a.stop()}},c,this)}));return function(){return a.apply(this,arguments)}}()},{key:"me",value:function(){var a=k(g.mark(function c(){var a;return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.parent.apiClient.me();
case 2:return a=b.sent,b.next=5,this.persistResponse(a);case 5:return b.abrupt("return",a.user);case 6:case "end":return b.stop()}},c,this)}));return function(){return a.apply(this,arguments)}}()},{key:"changePassword",value:function(){var a=k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.parent.apiClient.changePassword(a,b);case 2:return c=d.sent,d.next=5,this.persistResponse(c);case 5:return d.abrupt("return",c.user);case 6:case "end":return d.stop()}},
d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"updateMetadata",value:function(){var a=k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.parent.apiClient.updateMetadata(a);case 2:return b=c.sent,c.next=5,this.persistResponse(b);case 5:return c.abrupt("return",b.user);case 6:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"requestForgotPasswordEmail",value:function(){var a=
k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.parent.apiClient.requestForgotPasswordEmail(a));case 1:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.parent.apiClient.resetPassword(a));case 1:case "end":return b.stop()}},f,this)}));
return function(b){return a.apply(this,arguments)}}()},{key:"requestEmailVerification",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.parent.apiClient.requestEmailVerification(a));case 1:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"verifyWithCode",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",
this.parent.apiClient.verifyWithCode(a));case 1:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"loginWithCustomToken",value:function(){var a=k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.parent.apiClient.loginWithCustomToken(a,b);case 2:return c=d.sent,d.next=5,this.persistResponse(c);case 5:return d.abrupt("return",c.user);case 6:case "end":return d.stop()}},d,this)}));return function(b,
f){return a.apply(this,arguments)}}()},{key:"deleteOAuthProvider",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.parent.apiClient.deleteOAuthProvider(a));case 1:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"loginOAuthProviderWithAccessToken",value:function(){var a=k(g.mark(function h(a,b,d){var c;return g.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=
2,this.parent.apiClient.loginOAuthProviderWithAccessToken(a,b,d);case 2:return c=f.sent,f.next=5,this.persistResponse(c);case 5:return f.abrupt("return",c.user);case 6:case "end":return f.stop()}},h,this)}));return function(b,f,d){return a.apply(this,arguments)}}()},{key:"linkOAuthProviderWithAccessToken",value:function(){var a=k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.parent.apiClient.linkOAuthProviderWithAccessToken(a,b);case 2:return c=
d.sent,d.next=5,this.persistResponse(c);case 5:return d.abrupt("return",c.user);case 6:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"accessToken",get:function(){return this.parent.apiClient.accessToken}}]);return a}(),fd=function(){function a(b){y(this,a);if(!b.apiClient)throw Error("missing apiClient");if(!b.storage)throw Error("missing storage");this.name=b.name||"default";this.apiClient=b.apiClient;this.storage=b.storage;this.auth=new Ib(this)}
L(a,[{key:"configure",value:function(){var a=k(g.mark(function f(a){var b,c,k;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.apiClient.apiKey=a.apiKey,this.apiClient.endpoint=a.endpoint,d.next=4,this.storage.getAccessToken(this.name);case 4:return b=d.sent,this.apiClient.accessToken=b,d.next=8,this.storage.getUser(this.name);case 8:return c=d.sent,this.auth.currentUser=c,d.next=12,this.storage.getIdentity(this.name);case 12:k=d.sent,this.auth.currentIdentity=k;case 14:case "end":return d.stop()}},
f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"fetch",value:function(){var a=k(g.mark(function d(a,b){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.apiClient.fetch(a,b));case 1:case "end":return c.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()}]);return a}(),gd=function(){function a(b){y(this,a);this.driver=b}L(a,[{key:"safeDel",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=
b.next){case 0:return a="skygear2_".concat(a),b.prev=1,b.next=4,this.driver.del(a);case 4:b.next=8;break;case 6:b.prev=6,b.t0=b["catch"](1);case 8:case "end":return b.stop()}},f,this,[[1,6]])}));return function(b){return a.apply(this,arguments)}}()},{key:"safeGet",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return a="skygear2_".concat(a),b.prev=1,b.abrupt("return",this.driver.get(a));case 5:return b.prev=5,b.t0=b["catch"](1),b.abrupt("return",
null);case 8:case "end":return b.stop()}},f,this,[[1,5]])}));return function(b){return a.apply(this,arguments)}}()},{key:"safeGetJSON",value:function(){var a=k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.safeGet(a);case 2:b=c.sent;if(null!=b){c.next=5;break}return c.abrupt("return",void 0);case 5:return c.prev=5,c.abrupt("return",JSON.parse(b));case 9:return c.prev=9,c.t0=c["catch"](5),c.abrupt("return",void 0);case 12:case "end":return c.stop()}},
f,this,[[5,9]])}));return function(b){return a.apply(this,arguments)}}()},{key:"safeSet",value:function(){var a=k(g.mark(function d(a,b){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a="skygear2_".concat(a),c.prev=1,c.next=4,this.driver.set(a,b);case 4:c.next=8;break;case 6:c.prev=6,c.t0=c["catch"](1);case 8:case "end":return c.stop()}},d,this,[[1,6]])}));return function(b,f){return a.apply(this,arguments)}}()},{key:"safeSetJSON",value:function(){var a=k(g.mark(function d(a,
b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,c=JSON.stringify(b),d.next=4,this.safeSet(a,c);case 4:d.next=8;break;case 6:d.prev=6,d.t0=d["catch"](0);case 8:case "end":return d.stop()}},d,this,[[0,6]])}));return function(b,f){return a.apply(this,arguments)}}()}]);return a}(),hd=function(){function a(b){y(this,a);this.storage=new gd(b)}L(a,[{key:"setUser",value:function(){var a=k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=
Sb(b),d.next=3,this.storage.safeSetJSON("".concat(a,"_user"),c);case 3:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"setIdentity",value:function(){var a=k(g.mark(function d(a,b){var c;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=Tb(b),d.next=3,this.storage.safeSetJSON("".concat(a,"_identity"),c);case 3:case "end":return d.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"setAccessToken",
value:function(){var a=k(g.mark(function d(a,b){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.storage.safeSet(fb(a),b);case 2:case "end":return c.stop()}},d,this)}));return function(b,f){return a.apply(this,arguments)}}()},{key:"setOAuthRedirectAction",value:function(){var a=k(g.mark(function d(a,b){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.storage.safeSet(gb(a),b);case 2:case "end":return c.stop()}},d,this)}));return function(b,
f){return a.apply(this,arguments)}}()},{key:"getUser",value:function(){var a=k(g.mark(function f(a){var b;return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.storage.safeGetJSON("".concat(a,"_user"));case 2:b=c.sent;if(!b){c.next=5;break}return c.abrupt("return",cb(b));case 5:return c.abrupt("return",null);case 6:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"getIdentity",value:function(){var a=k(g.mark(function f(a){var b;
return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.storage.safeGetJSON("".concat(a,"_identity"));case 2:b=c.sent;if(!b){c.next=5;break}return c.abrupt("return",db(b));case 5:return c.abrupt("return",null);case 6:case "end":return c.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"getAccessToken",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.storage.safeGet(fb(a)));
case 1:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"getOAuthRedirectAction",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.storage.safeGet(gb(a)));case 1:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"delUser",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=
b.next){case 0:return b.next=2,this.storage.safeDel("".concat(a,"_user"));case 2:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"delIdentity",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.storage.safeDel("".concat(a,"_identity"));case 2:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"delAccessToken",value:function(){var a=
k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.storage.safeDel(fb(a));case 2:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"delOAuthRedirectAction",value:function(){var a=k(g.mark(function f(a){return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.storage.safeDel(gb(a));case 2:case "end":return b.stop()}},f,this)}));return function(b){return a.apply(this,arguments)}}()}]);
return a}(),id=function(a){function b(){var a;y(this,b);var c=arguments.length;for(var f=Array(c),d=0;d<c;d++)f[d]=arguments[d];c=Ea(this,(a=O(b)).call.apply(a,[this].concat(f)));hb(Da(c),"fetchFunction",window.fetch.bind(window));hb(Da(c),"requestClass",Request);return c}Fa(b,a);return b}(ed),Jb=localStorage,jd={get:function(){var a=k(g.mark(function c(a){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Jb.getItem(a));case 1:case "end":return c.stop()}},c)}));
return function(e){return a.apply(this,arguments)}}(),set:function(){var a=k(g.mark(function f(a,c){return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Jb.setItem(a,c));case 1:case "end":return d.stop()}},f)}));return function(e,c){return a.apply(this,arguments)}}(),del:function(){var a=k(g.mark(function c(a){return g.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Jb.removeItem(a));case 1:case "end":return c.stop()}},c)}));return function(e){return a.apply(this,
arguments)}}()},Le={},Me=function(){function a(){y(this,a);this.token=null}L(a,[{key:"subscribe",value:function(a){var b=this;this.unsubscribe();return new Promise(function(c,e){b.token=window.setInterval(function(){a.closed&&e(Le)},1E3)})}},{key:"unsubscribe",value:function(){this.token&&(window.clearInterval(this.token),this.token=null)}}]);return a}(),kd=function(){function a(b){y(this,a);this.origin=b.replace(/\/$/,"");this.onMessage=null}L(a,[{key:"subscribe",value:function(){var a=this;this.unsubscribe();
return new Promise(function(b){a.onMessage=function(c){a.origin===c.origin&&(b(c.data),a.unsubscribe())};window.addEventListener("message",a.onMessage)})}},{key:"unsubscribe",value:function(){this.onMessage&&(window.removeEventListener("message",this.onMessage),this.onMessage=null)}}]);return a}(),ld=function(a){function b(a){y(this,b);a=Ea(this,O(b).call(this,a));a.oauthWindowObserver=null;a.oauthResultObserver=null;return a}Fa(b,a);L(b,[{key:"_oauthProviderPopupFlow",value:function(){var a=k(g.mark(function m(a,
b,e){var d,f,h;return g.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(d=window.open("","_blank","height=700,width=500")){g.next=3;break}throw Error("could not open new window");case 3:return null==this.oauthWindowObserver&&(this.oauthWindowObserver=new Me),null==this.oauthResultObserver&&(this.oauthResultObserver=new kd(this.parent.apiClient.endpoint)),g.prev=5,g.next=8,this.parent.apiClient.oauthAuthorizationURL(a,{action:b,uxMode:"web_popup",mergeRealm:e&&e.mergeRealm,onUserDuplicate:e&&
e.onUserDuplicate});case 8:return f=g.sent,d.location.href=f,g.next=12,Promise.race([this.oauthWindowObserver.subscribe(d),this.oauthResultObserver.subscribe()]);case 12:return h=g.sent,g.abrupt("return",Wb(h));case 14:return g.prev=14,d.close(),this.oauthWindowObserver&&this.oauthWindowObserver.unsubscribe(),this.oauthResultObserver&&this.oauthResultObserver.unsubscribe(),g.finish(14);case 19:case "end":return g.stop()}},m,this,[[5,,14,19]])}));return function(b,d,e){return a.apply(this,arguments)}}()},
{key:"loginOAuthProviderWithPopup",value:function(){var a=k(g.mark(function h(a,b){var d,e;return g.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._oauthProviderPopupFlow(a,"login",b);case 2:return d=f.sent,e=Ha(d),this.persistResponse(e),f.abrupt("return",e.user);case 6:case "end":return f.stop()}},h,this)}));return function(b,d){return a.apply(this,arguments)}}()},{key:"linkOAuthProviderWithPopup",value:function(){var a=k(g.mark(function d(a){return g.wrap(function(b){for(;;)switch(b.prev=
b.next){case 0:return b.next=2,this._oauthProviderPopupFlow(a,"link");case 2:case "end":return b.stop()}},d,this)}));return function(b){return a.apply(this,arguments)}}()},{key:"loginOAuthProviderWithRedirect",value:function(){var a=k(g.mark(function m(a,b,e){var d;return g.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.parent.apiClient.oauthAuthorizationURL(a,{callbackURL:b,action:"login",uxMode:"web_redirect",mergeRealm:e&&e.mergeRealm,onUserDuplicate:e&&e.onUserDuplicate});
case 2:return d=f.sent,f.next=5,this.parent.storage.setOAuthRedirectAction(this.parent.name,"login");case 5:window.location.href=d;case 6:case "end":return f.stop()}},m,this)}));return function(b,d,e){return a.apply(this,arguments)}}()},{key:"linkOAuthProviderWithRedirect",value:function(){var a=k(g.mark(function h(a,b){var d;return g.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.parent.apiClient.oauthAuthorizationURL(a,{callbackURL:b,action:"link",uxMode:"web_redirect"});
case 2:return d=e.sent,e.next=5,this.parent.storage.setOAuthRedirectAction(this.parent.name,"link");case 5:window.location.href=d;case 6:case "end":return e.stop()}},h,this)}));return function(b,d){return a.apply(this,arguments)}}()},{key:"_getRedirectResult",value:function(){var a=k(g.mark(function d(a){var b,e,f,k;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return null==this.oauthResultObserver&&(this.oauthResultObserver=new kd(this.parent.apiClient.endpoint)),d.prev=1,d.next=
4,this.parent.storage.getOAuthRedirectAction(this.parent.name);case 4:e=d.sent;if(e===a){d.next=7;break}return d.abrupt("return",void 0);case 7:return d.next=9,this.parent.storage.delOAuthRedirectAction(this.parent.name);case 9:return f=this.oauthResultObserver.subscribe(),b=document.createElement("iframe"),b.style.display="none",b.src=this.parent.apiClient.endpoint+"/_auth/sso/iframe_handler",document.body.appendChild(b),d.next=16,f;case 16:return k=d.sent,d.abrupt("return",Wb(k));case 18:return d.prev=
18,b&&(this.oauthResultObserver.unsubscribe(),document.body.removeChild(b)),d.finish(18);case 21:case "end":return d.stop()}},d,this,[[1,,18,21]])}));return function(b){return a.apply(this,arguments)}}()},{key:"getLoginRedirectResult",value:function(){var a=k(g.mark(function f(){var a,b;return g.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this._getRedirectResult("login");case 2:if(a=d.sent){d.next=5;break}return d.abrupt("return",null);case 5:return b=Ha(a),this.persistResponse(b),
d.abrupt("return",b.user);case 8:case "end":return d.stop()}},f,this)}));return function(){return a.apply(this,arguments)}}()},{key:"getLinkRedirectResult",value:function(){var a=k(g.mark(function f(){var a;return g.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._getRedirectResult("link");case 2:if(a=b.sent){b.next=5;break}return b.abrupt("return",null);case 5:return b.abrupt("return",!0);case 6:case "end":return b.stop()}},f,this)}));return function(){return a.apply(this,
arguments)}}()}]);return b}(Ib),md=function(a){function b(a){y(this,b);a=ud({},a,{apiClient:a&&a.apiClient||new id({apiKey:"",endpoint:"",accessToken:null}),storage:a&&a.storage||new hd(jd)});a=Ea(this,O(b).call(this,a));a.auth=new ld(Da(a));return a}Fa(b,a);return b}(fd),Ne=new md;n.AuthContainer=Ib;n.BaseAPIClient=ed;n.Container=fd;n.GlobalJSONContainerStorage=hd;n.SkygearError=Pb;n.VERSION="VERSION";n.WebAPIClient=id;n.WebAuthContainer=ld;n.WebContainer=md;n._GlobalJSONStorage=gd;n.decodeAuthResponse=
Ha;n.decodeError=Ga;n.decodeIdentity=db;n.decodeUser=cb;n.defaultContainer=Ne;n.encodeIdentity=Tb;n.encodeQuery=Ub;n.encodeQueryComponent=eb;n.encodeUser=Sb;n.localStorageStorageDriver=jd;return n}({});
